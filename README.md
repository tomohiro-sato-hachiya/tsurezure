# tsurezure
## 本アプリの概要
Djangoによって制作したWEBアプリになります。
ユーザがMarkdown形式で作成した記事を投稿、その記事を他のユーザが閲覧したり、コメントを投稿することができます。

## 使用技術
### バックエンド
#### 言語
- Python
#### フレームワーク
- Django
##### プラグイン
- django-bootstrap4
- django-cleanup
- django-imagekit ※左記プラグインにはPillowも別途必要
- django-markdownx
- WhiteNoise
### フロントエンド
#### 言語
- html
- CSS
- JavaScript
#### フレームワーク
- Bootstrap4
- jQuery
※どちらともdjango-bootstrap4によって導入

## 動作環境
| 技術 | バージョン |
| ---- | ---- |
| Python | 3.7.4 |
| Django | 3.0.3 |
| django-bootstrap4 | 1.1.1 |
| django-cleanup | 4.0.0 |
| django-imagekit | 4.0.2 |
| Pillow | 6.2.0 |
| django-markdownx | 3.0.1 |
| WhiteNoise | 5.0.1 |

## WEBアプリ起動までの流れ
### マイグレーションを行う
/django/tsurezure配下で下記コマンドを実行してください。
```console
python manage.py makemigrations tsurezure 
```
上記コマンド成功後、下記コマンドを実行してください。
```console
python manage.py migrate
```
上記コマンドが成功すればマイグレーションは完了です。
### サーバ起動を行う
マイグレーションを行なった同フォルダ内で、下記コマンドを実行してください。
```console
python manage.py runserver
```
正常終了し、下記URLでトップページに遷移できれば成功です。
 http://127.0.0.1:8000/tsurezure/top/

### 各画面の概要
ここでは、ユーザとして本WEBアプリを使用するにあたり、最も想定しうる画面遷移に沿って、各画面を説明していきます。

なお、エラー画面については記載対象外とします。
#### トップ画面
##### URL
- http://127.0.0.1:8000/tsurezure/top/
- http://127.0.0.1:8000/tsurezure/top/<int:page>/
##### ログインの必要是非
必要なし
##### 概要
本画面では、投稿された全ての記事が10本ずつ、最新のものから順にページネーションによって閲覧することができます。「記事を読む」ボタンを押下すれば「記事閲覧」画面に遷移できます。

上記URLのうち、1つ目を入力すると1ページ目が表示され、2つ目を入力すると指定したページが表示されます。

なお、ページネーションの仕様は、後述する「ユーザ」画面、「投稿記事」画面でも同様です。
#### 共通部分
##### URL
(共通部分なので記載なし)
##### ログインの必要是非
(共通部分なので記載なし)
##### 概要
厳密には画面ではありませんが、本WEBアプリを使用するにあたり理解していただく必要があるのでこの場において説明します。

共通部分として重要な箇所は、主にナビゲーションバー、サイドバーになります。

ナビゲーションバーからは、記事の閲覧や新規投稿に関する画面に遷移できます。具体的には、「トップ」画面、「投稿記事」画面、「投稿記事の編集」画面に遷移するためのナビゲーションバーとなっています。

サイドバーはユーザ情報を扱う箇所となっています。具体的には、ユーザがログインしている状態では「パスワードの確認」画面に遷移することができる他、「ログアウトする」ボタンからログアウトが可能です。一方、ユーザがログインしていない状態では「ログイン」画面、「ユーザ登録」画面に遷移できるようになります。なお、エラーページの場合、バックエンド側からユーザ情報がフロントエンド側に受け渡せないため、サイドバーは表示しない仕様にしております。
#### ユーザ登録
##### URL
- http://127.0.0.1:8000/tsurezure/login/
##### ログインの必要是非
必要なし
##### 概要
ユーザ名、パスワードを設定してユーザ情報を登録します。

登録に成功時、ログイン処理が行われて「トップ」画面に遷移します。
#### 記事投稿
##### URL
- http://127.0.0.1:8000/tsurezure/article-create/
##### ログインの必要是非
必要あり
##### 概要
タイトルと本文を記述して、記事を投稿することができます。

本文に画像を使用したいときには、本文に画像をドロップすることで記事に使用されるようになります。フォームの下には本文の内容が表示されますので、内容がどのように表示されるのか確認しながら執筆ができます。

記事投稿に成功した場合、その記事の「記事閲覧」画面に遷移します。
#### 記事閲覧
##### URL
- http://127.0.0.1:8000/tsurezure/article-detail/<int:article_id>/
##### ログインの必要是非
必要なし ※コメントを記載する場合には必要あり
##### 概要
IDによって指定された記事やその記事へのコメントの閲覧、コメントの投稿が行えます。

投稿者やコメンターの「ユーザ」画面へ遷移することも可能です。
#### ユーザ
##### URL
- http://127.0.0.1:8000/tsurezure/user/<username>/
- http://127.0.0.1:8000/tsurezure/user/<username>/<int:page>/
##### ログインの必要是非
必要なし
##### 概要
指定したユーザのプロフィールや投稿記事一覧が閲覧できます。
#### 投稿記事
##### URL
- http://127.0.0.1:8000/tsurezure/my-articles/
- http://127.0.0.1:8000/tsurezure/my-articles/<int:page>/
##### ログインの必要是非
必要あり
##### 概要
自分が投稿した記事の一覧が閲覧できます。

ボタンを押下することで、選んだ記事の「記事閲覧」画面や「投稿記事の編集」画面に遷移できます。
#### 投稿記事の編集
##### URL
- http://127.0.0.1:8000/tsurezure/article-update/<int:article_id>/
##### ログインの必要是非
必要あり
##### 概要
選んだ記事を再編集することができます。

再編集に成功した場合、その記事の「記事閲覧」画面に遷移します。
#### パスワードの確認
##### URL
- http://127.0.0.1:8000/tsurezure/password-confirmation/
##### ログインの必要是非
必要なし
##### 概要
「ユーザ情報の確認・更新」画面に遷移する前にパスワードを再確認するための画面です。

ユーザがログインしている場合には確認用フォームが表示され、ユーザがログインしていない場合には「ログイン」画面に遷移します。
#### ユーザ情報の確認・更新
##### URL
- http://127.0.0.1:8000/tsurezure/user-update/
##### ログインの必要是非
必要あり
##### 概要
アイコンやプロフィールの変更ができる他、「パスワード変更」画面に遷移できます。

なお、「パスワードの確認」画面でのパスワード確認を経ず、直接本画面に遷移すると、「パスワードの確認」に遷移する仕様を、セッション情報を活用することにより実現しています。
#### パスワード変更
##### URL
- http://127.0.0.1:8000/tsurezure/password-change/
##### ログインの必要是非
必要あり
##### 概要
パスワードの変更を行うことができます。

なお、本画面では変更前のパスワードの確認も行うため、「パスワードの確認」画面でのパスワード確認は必須とはしていません。
